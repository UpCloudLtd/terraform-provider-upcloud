variable "basename" {
  type    = string
  default = "tf-acc-test-lb-cert-norm"
}

# Step 2: Switch to clean certificates (should cause a diff)
locals {
  # Clean certificate (no extra whitespace)
  certificate_clean = base64encode(<<-EOT
-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIUG4u+4CfiGCzPH98t08AxyVA4C5gwDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yMjAzMTcxMzE1MDhaFw0yMzAz
MTcxMzE1MDhaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggIiMA0GCSqGSIb3DQEB
AQUAA4ICDwAwggIKAoICAQDvZxn/+zTyW4ERvKkwWomUpi8o2tJz1dver+DJrK3g
CNlUoYzR29CWs7jK81XMsvmqL5MzTwP7Hsmd1q69FI+WcPE1aab9909IAk/GGiK2
zTleN3EQQpXn7tnyPtZaT8Y13yFHpC5RgQzTE8CR9Zi2OLEyxGQ36pA6190nxVg2
SLlafNGTZtJvN1/7r9mJhElbrUE+joeXLwNojH/nXk5W/XwzZboIHsSFVYjK2zlg
oqC6+Apo9xF9oY7nlAhQ0KKWvQVbwjGPmVN17ETodHsKJZBoXxDsZUTGCDDJCimz
W64a79lWIxiyOQ4/7Tn2FhPY0omH5UbWCPq2MnXebkOjgcvUY4NIwzpYV0W2GGGG
wwni9fllYAM9OD3bvPX5OaAWNJT6r6EassjWlv0TeGxE+BZZ+g3xPqHTGz2wHzC5
5anLDjM+4vsBVkfkV3SY7W83m74VQ+Qa3WaNXzinL0keFxupLXY8bKhEzXzSLKz+
Br8PGeGRgaSDd1kpFPg+ujN8qvgo0RDI8IqLS7zbXFoQrp1x/dWm9S8DVEXVoUA1
WQnVuWECoBS4Zf41d04pfdCttnN9zHosgwXbJ8m0TfvfkuhViuVAN/p+Mp9WnQ+H
11HEnWpSfOh7ZPjTzjuAsevVfV4g4a3kczMv1rpNPzUUPwtAqx9239wwIR9Y15cl
OQIDAQABo1MwUTAdBgNVHQ4EFgQUXIqlbj5uMUFT/jqM2kWvYZtDNkcwHwYDVR0j
BBgwFoAUXIqlbj5uMUFT/jqM2kWvYZtDNkcwDwYDVR0TAQH/BAUwAwEB/zANBgkq
hkiG9w0BAQsFAAOCAgEACM+xbb9okUGOqkQZkgtxwyQtzotXTW6yHbgfxhBwwuv+
sImOT29L9XUYnS9q8+BKAHuFkrSEIpGFUUhCUfSkle6fnGG5oNOZmCtK37thfQU9
v4Bo8qBZHjDHwk9VTtaZmAk0KbxfhugyWVCVlmDZroSCOiWGkTVhsXaKDkbw4El0
2scygbACtVxnE5Z9fSAw1OPYrYaG2InGL4/0uRez8iyuPOe5Cb/Dd49uxqsGQd3R
C7J4/oZpvoEzQRmjLboQsC90SfjhSiphGBSbaJBddl00k5VsUrqKXZSM8qQqUfV/
nlBmb2NnUlkde8KHs0PjhBho+/7fj+L7mFa2l5jfuiltuqvh2ZyZtRcwgbvbeiLO
fPIiLCgSns0j+Y2EkKWkEJzErPVnl97ZBKYrPZbdX0V9ogoL/jxEy79lo9Js29v6
RF66goJU02EJe502i7Xrs31YCKnHgvz50L6akBiadR6kkMuWvBuwYz0IZKTLqxjd
08GeRBUyalPVhtfJo3MutnaIe/ZVU7KAIwKVgom3KODcTiZYPWtV+1g/E/7p5hhv
BDG1jrIQsVkdn25fa5sd5OPkP/l0Quv5zmzPI7KS+KfeY/v4qA90m4i6vFNFTmm0
HSWWBYNTxnR1b96PITrts8MyjoXLX6Bu1VFNJPr2Jg02LVVoq6RIbe1Uo619ojA=
-----END CERTIFICATE-----
EOT
  )

  # Clean intermediates
  intermediates_clean = base64encode(<<-EOT
-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIUG4u+4CfiGCzPH98t08AxyVA4C5gwDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yMjAzMTcxMzE1MDhaFw0yMzAz
MTcxMzE1MDhaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggIiMA0GCSqGSIb3DQEB
AQUAA4ICDwAwggIKAoICAQDvZxn/+zTyW4ERvKkwWomUpi8o2tJz1dver+DJrK3g
CNlUoYzR29CWs7jK81XMsvmqL5MzTwP7Hsmd1q69FI+WcPE1aab9909IAk/GGiK2
zTleN3EQQpXn7tnyPtZaT8Y13yFHpC5RgQzTE8CR9Zi2OLEyxGQ36pA6190nxVg2
SLlafNGTZtJvN1/7r9mJhElbrUE+joeXLwNojH/nXk5W/XwzZboIHsSFVYjK2zlg
oqC6+Apo9xF9oY7nlAhQ0KKWvQVbwjGPmVN17ETodHsKJZBoXxDsZUTGCDDJCimz
W64a79lWIxiyOQ4/7Tn2FhPY0omH5UbWCPq2MnXebkOjgcvUY4NIwzpYV0W2GGGG
wwni9fllYAM9OD3bvPX5OaAWNJT6r6EassjWlv0TeGxE+BZZ+g3xPqHTGz2wHzC5
5anLDjM+4vsBVkfkV3SY7W83m74VQ+Qa3WaNXzinL0keFxupLXY8bKhEzXzSLKz+
Br8PGeGRgaSDd1kpFPg+ujN8qvgo0RDI8IqLS7zbXFoQrp1x/dWm9S8DVEXVoUA1
WQnVuWECoBS4Zf41d04pfdCttnN9zHosgwXbJ8m0TfvfkuhViuVAN/p+Mp9WnQ+H
11HEnWpSfOh7ZPjTzjuAsevVfV4g4a3kczMv1rpNPzUUPwtAqx9239wwIR9Y15cl
OQIDAQABo1MwUTAdBgNVHQ4EFgQUXIqlbj5uMUFT/jqM2kWvYZtDNkcwHwYDVR0j
BBgwFoAUXIqlbj5uMUFT/jqM2kWvYZtDNkcwDwYDVR0TAQH/BAUwAwEB/zANBgkq
hkiG9w0BAQsFAAOCAgEACM+xbb9okUGOqkQZkgtxwyQtzotXTW6yHbgfxhBwwuv+
sImOT29L9XUYnS9q8+BKAHuFkrSEIpGFUUhCUfSkle6fnGG5oNOZmCtK37thfQU9
v4Bo8qBZHjDHwk9VTtaZmAk0KbxfhugyWVCVlmDZroSCOiWGkTVhsXaKDkbw4El0
2scygbACtVxnE5Z9fSAw1OPYrYaG2InGL4/0uRez8iyuPOe5Cb/Dd49uxqsGQd3R
C7J4/oZpvoEzQRmjLboQsC90SfjhSiphGBSbaJBddl00k5VsUrqKXZSM8qQqUfV/
nlBmb2NnUlkde8KHs0PjhBho+/7fj+L7mFa2l5jfuiltuqvh2ZyZtRcwgbvbeiLO
fPIiLCgSns0j+Y2EkKWkEJzErPVnl97ZBKYrPZbdX0V9ogoL/jxEy79lo9Js29v6
RF66goJU02EJe502i7Xrs31YCKnHgvz50L6akBiadR6kkMuWvBuwYz0IZKTLqxjd
08GeRBUyalPVhtfJo3MutnaIe/ZVU7KAIwKVgom3KODcTiZYPWtV+1g/E/7p5hhv
BDG1jrIQsVkdn25fa5sd5OPkP/l0Quv5zmzPI7KS+KfeY/v4qA90m4i6vFNFTmm0
HSWWBYNTxnR1b96PITrts8MyjoXLX6Bu1VFNJPr2Jg02LVVoq6RIbe1Uo619ojA=
-----END CERTIFICATE-----
-----BEGIN CERTIFICATE-----
MIIFazCCA1OgAwIBAgIUG4u+4CfiGCzPH98t08AxyVA4C5gwDQYJKoZIhvcNAQEL
BQAwRTELMAkGA1UEBhMCQVUxEzARBgNVBAgMClNvbWUtU3RhdGUxITAfBgNVBAoM
GEludGVybmV0IFdpZGdpdHMgUHR5IEx0ZDAeFw0yMjAzMTcxMzE1MDhaFw0yMzAz
MTcxMzE1MDhaMEUxCzAJBgNVBAYTAkFVMRMwEQYDVQQIDApTb21lLVN0YXRlMSEw
HwYDVQQKDBhJbnRlcm5ldCBXaWRnaXRzIFB0eSBMdGQwggIiMA0GCSqGSIb3DQEB
AQUAA4ICDwAwggIKAoICAQDvZxn/+zTyW4ERvKkwWomUpi8o2tJz1dver+DJrK3g
CNlUoYzR29CWs7jK81XMsvmqL5MzTwP7Hsmd1q69FI+WcPE1aab9909IAk/GGiK2
zTleN3EQQpXn7tnyPtZaT8Y13yFHpC5RgQzTE8CR9Zi2OLEyxGQ36pA6190nxVg2
SLlafNGTZtJvN1/7r9mJhElbrUE+joeXLwNojH/nXk5W/XwzZboIHsSFVYjK2zlg
oqC6+Apo9xF9oY7nlAhQ0KKWvQVbwjGPmVN17ETodHsKJZBoXxDsZUTGCDDJCimz
W64a79lWIxiyOQ4/7Tn2FhPY0omH5UbWCPq2MnXebkOjgcvUY4NIwzpYV0W2GGGG
wwni9fllYAM9OD3bvPX5OaAWNJT6r6EassjWlv0TeGxE+BZZ+g3xPqHTGz2wHzC5
5anLDjM+4vsBVkfkV3SY7W83m74VQ+Qa3WaNXzinL0keFxupLXY8bKhEzXzSLKz+
Br8PGeGRgaSDd1kpFPg+ujN8qvgo0RDI8IqLS7zbXFoQrp1x/dWm9S8DVEXVoUA1
WQnVuWECoBS4Zf41d04pfdCttnN9zHosgwXbJ8m0TfvfkuhViuVAN/p+Mp9WnQ+H
11HEnWpSfOh7ZPjTzjuAsevVfV4g4a3kczMv1rpNPzUUPwtAqx9239wwIR9Y15cl
OQIDAQABo1MwUTAdBgNVHQ4EFgQUXIqlbj5uMUFT/jqM2kWvYZtDNkcwHwYDVR0j
BBgwFoAUXIqlbj5uMUFT/jqM2kWvYZtDNkcwDwYDVR0TAQH/BAUwAwEB/zANBgkq
hkiG9w0BAQsFAAOCAgEACM+xbb9okUGOqkQZkgtxwyQtzotXTW6yHbgfxhBwwuv+
sImOT29L9XUYnS9q8+BKAHuFkrSEIpGFUUhCUfSkle6fnGG5oNOZmCtK37thfQU9
v4Bo8qBZHjDHwk9VTtaZmAk0KbxfhugyWVCVlmDZroSCOiWGkTVhsXaKDkbw4El0
2scygbACtVxnE5Z9fSAw1OPYrYaG2InGL4/0uRez8iyuPOe5Cb/Dd49uxqsGQd3R
C7J4/oZpvoEzQRmjLboQsC90SfjhSiphGBSbaJBddl00k5VsUrqKXZSM8qQqUfV/
nlBmb2NnUlkde8KHs0PjhBho+/7fj+L7mFa2l5jfuiltuqvh2ZyZtRcwgbvbeiLO
fPIiLCgSns0j+Y2EkKWkEJzErPVnl97ZBKYrPZbdX0V9ogoL/jxEy79lo9Js29v6
RF66goJU02EJe502i7Xrs31YCKnHgvz50L6akBiadR6kkMuWvBuwYz0IZKTLqxjd
08GeRBUyalPVhtfJo3MutnaIe/ZVU7KAIwKVgom3KODcTiZYPWtV+1g/E/7p5hhv
BDG1jrIQsVkdn25fa5sd5OPkP/l0Quv5zmzPI7KS+KfeY/v4qA90m4i6vFNFTmm0
HSWWBYNTxnR1b96PITrts8MyjoXLX6Bu1VFNJPr2Jg02LVVoq6RIbe1Uo619ojA=
-----END CERTIFICATE-----
EOT
  )

  # Private key
  private_key = base64encode(<<-EOT
-----BEGIN PRIVATE KEY-----
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
yvdIzvxFQflxbO+kYnt3dpTHuCnRCH0S4Q==
-----END PRIVATE KEY-----
EOT
  )
}

resource "upcloud_loadbalancer_manual_certificate_bundle" "this" {
  name          = "${var.basename}-cert"
  certificate   = local.certificate_clean
  intermediates = local.intermediates_clean
  private_key   = local.private_key
}
